<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <title>Color Rainbow - User Input</title>

    <style>
      #colors {
        line-height: 1;
        /* width: 100%; */
        width: 500px;
        margin: 25px auto;
      }

      div.colorBlock {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: inline-block;
        margin: auto 10px;
      }

    /* for class rbc* 
      div[class^="rbc"] { 
        width: 500px;
        height: 55px;
        margin: auto 10px;
      }
    */
    </style>
  </head>
  <body id="content">
    <h1 style="margin: 25px auto; width: 500px; text-align: center;">
      Click me to create rainbow colors
    </h1>
    <div id="colors"></div>

    <p style="margin: 12px auto; width: 450px; text-align: center;">
      <button id="clickMe" onclick="initialize();">Click me</button>
      <button id="restoreAll" onclick="restorAll();">Restore all</button>
    </p>

    <script>
      //var num = 7

      var rgbColors = [
        [255, 0, 0],    // Red
        [255, 127, 0],  // Orange
        [255, 255, 0],  // Yellow
        [0, 255, 0],    // Green
        [0, 0, 255],    // Blue
        [75, 0, 130],   // Indigo
        [148, 0, 211]   // Violet
      ];

      function createRainbowBlocks() {
        var num = -1;

        while (num < 7 || num > 20) {
          numStr = prompt("請輸入一個介於 7 到 20 的整數： ");
          num = parseInt(numStr);
        }
        //alert(num);

        var blocks = "", colorBk;
        var red, green, blue, r, g, b, incR, incG, incB;

        for (var i = 0, len = rgbColors.length; i < len; i++) {
          r = rgbColors[i][0]; 
          g = rgbColors[i][1];
          b = rgbColors[i][2];
          incR = Math.floor((255 - r) / num);
          incG = Math.floor((255 - g) / num);
          incB = Math.floor((255 - b) / num);

          //新建外層 div, 包覆 n 個 colorBlocks
          var classname = "row rbc" + i;
          blocks += '<div class="' + classname + '">'; // starting div;

          for (var j = 0; j < num; j++) {
            red = r + incR * j;
            green = g + incG * j;
            blue = b + incB * j;
            colorBk = '<div class="colorBlock" style="background-color: rgb(' + 
              red + ',' + green + ',' + blue + ')"></div>'

            blocks += colorBk;
          }

          blocks += "</div>"; // ending div
        }

        // change colors' inline styles width and margin
        var elem = document.getElementById("colors");
        var cssString = "width:" + (num * 70 + 6) + "px;" + "margin: auto;";

        elem.style.cssText = cssString;
        elem.innerHTML = blocks;
      }

      function initialize() {
        createRainbowBlocks(); // 生成彩色球
        var x = document.getElementsByClassName("colorBlock");
        for (i = 0; i < x.length; i++) {
          x[i].addEventListener("mousedown", highLightRow);
          x[i].addEventListener("mouseup", hideRow);
        }
      }

      function highLightRow(event) {
        var parent = event.target.parentElement;
        // alert(parent.className);
        parent.style.border = "3px solid black";
      }

      function hideRow(event) {
        var parent = event.target.parentElement;
        parent.style.display = "none";
      }

      function restorAll() {
        //var rows = document.getElementsByClassName("row");
        var rows = document.querySelectorAll("[class*=rbc]");
        for (var i = 0; i < rows.length; i++) {
          rows[i].style.display = "";
          rows[i].style.border = "none";
        }
      }
    </script>
  </body>
</html>
